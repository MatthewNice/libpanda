

Ethernet disconeect/connected
wlan0 connected/disconnected
wlan0 in range of AP
Internet available 8.8.8.8



Action: start AP:
check if running: return if yes
 - Action: start hostapd
 - Action: start idc-dhcp-server on wlan0

Action: stop AP:
 - Action: stop isc-dhcp-server
 - Action: stop hostapd

Action start eth0 server:
check if isc-server running on eth0: Return if running
 - Action: set static IP on eth0
 - Action: start isc-dhcp-server on eth0

Action stop eth0 server:
check if isc-server running on eth0: Return if No
 - Action: stop isc-dhcp-server on eth0
 - Action: enable dhcp on eth0
 - Action: if down/up eth0



Scenario 0: Internet active: (If internet is active then there is no need to change anything since things are already going right)
check 8.8.8.8: active
 - Action: return
Now in state: unchanged


Scenario 1: no connection, hostap down, no known AP: (this is the effective boot state, nothing active nor connected)
check 8.8.8.8: none
check ethernet connected: disconnected
check wlan0 connected: none
scan for known AP: none found
check if hostap active: inactive
 - Action: start AP
 - Action: start eth0 server
Now in state: AP router
Prior states: Initial



Scenario 2: no connection, hostapd down, known AP available: (boot state with AP around, or when AP comes into contact )
check 8.8.8.8: none
check ethernet connected: disconnected
check wlan0 connected: none
scan for known AP: Known found
 - Action: stop AP
 - Action: connect to known AP
 - Action: invoke dhclient on wlan0
 - Action: start eth0 server
Now in state: Reverse Router
Prior states: Initial, AP Router
Transition reason: Known AP found


Scenario 3: ethernet connection to internet just made, dhcp server running on 
check 8.8.8.8: none
check ethernet connected: connected
Check if dhclient succeeds on eth0: succeed
Check 8.8.8.8: success
Action: Start hostapd (doesn't matter if running or not)












